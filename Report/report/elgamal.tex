\subsection{El Gamal Cryptography}

The El Gamal cryptosystem is based on group theory \cite[p.~297]{hac},
to which a short introduction is provided in Appendix A. In full
generality, a public key cryptosystem, or an assymetric cryptosystem,
provides two parties the means to communicate privately without the
need of sharing a common secret beforehand as is the case in symmetric
cryptography. The cryptosystem consists of a public key, a secret key
and two functions - one encryption function which uses the public key
and one decryption function which uses the secret key
\cite[p.~283]{hac}.

In the El Gamal cryptosystem the communicating parties agrees on a
suitable cyclic group and a generator element. The secret key is an
integer, while the public key is a group element - the exponentation
of the generator by the secret key integer
\cite[p.~297]{hac}. Encryption of a message (note that the messages
need to be encoded into elements of the group) is done by multiplying
the message with a group element that has a special relation to the
public key. Now, only the possessor of the secret key can decrypt,
since without the key it is unfeasible to invert this
multiplication. This is a slight simplification, but it should capture
the main idea of the cryptosystem.

Security of asymmetric cryptosystem depend on the assumption that
there exist computationally difficult problems
\cite[p.~306]{hac}. This is the case also for the El Gamal
cryptosystem for which the security depends on the difficulty of
deducing information about the discrete logarithm in a cyclic group
\cite[p.~294]{hac}.

As we shall see, the El Gamal cryptosystem possesses some special
properties that will be useful in creating a mix-net.

\subsubsection{Definition}
The El Gamal cryptosystem is defined over a cyclic group $G_q =
\left<g\right>$ of prime order $q$, generated by $g \in G_q$. A
private key $sk = x \in \mathbb{Z}_q$ is chosen randomly and is used
to compute the public key $pk = (g,y) \in G_q \times G_q$ where $y =
g^x$.

Encryption of a plaintext $m \in G_q$, denoted
$\mathrm{Enc}_{pk}(m,s)$, is done by choosing a random $s \in
\mathbb{Z}_q$ and computing
$$
\mathrm{Enc}_{pk}(m,s) = (u,v) \in G_q \times G_q
$$

 where $u = g^s$ and $v = y^sm$. Decryption of a ciphertext $(u,v) \in
 G_q \times G_q$, denoted $\mathrm{Dec}_{sk}(u,v)$, is achieved by
 using the private key $x$ to compute
$$
\mathrm{Dec}_{sk}(u,v) = u^{-x}v =
(g^s)^{-x}y^sm = (g^x)^{-s}y^sm = y^{-s}y^sm = m
$$

One common choice of group to use in the El Gamal cryptosystem is a
multiplicative subgroup $G_q \subset \mathbb{Z}_p^*$, where $p = kq +
1$, for some $k$. Another common choice is to use certain elliptic
curves, in which case one may obtain the same security with a smaller
group and hence a more space efficient implementation
\cite[p.~297]{hac}.

\subsubsection{Security}
In order to use a cryptosystem in good conscience we need to address
the issue of security. One commonly used security definition is
semantic security. A cryptosystem is said to be semantically secure if
any efficient (probabilistic, polynomial time) algorithm cannot with
non-negligible probability distinguish between the encryption of two
different plaintexts \cite[p.~306]{hac}. This means that if an
attacker is given the encryption of one of two possible plaintexts he
or she will not be able to tell which plaintext was encrypted better
than just guessing. The semantic security of the El Gamal cryptosystem
relies on the Decisional Diffie-Hellman assumption (Lecture 08
Wikström DD2448), which is explained below.

Let $b = g^a \in G_q$ where $a \in \mathbb{Z}_q$, then $a$ is said to
be the discrete logarithm of $b$ in the group $G_q$. There is
currently no known efficient classical algorithm that given a general
group $G_q$, $g$ and $b$ as above, is able to calculate $a$ in a
reasonable amount of time (polynomial time) \cite[p.~103]{hac}

The Decisional Diffie-Hellman assumption concerns a problem related to
the discrete logarithm. The assumption in a certain group $G_q$ means
that if $a,b,c \in \mathbb{Z}_q$ are chosen randomly, every efficient
algorithm, on input $g^a$, $g^b$ and $y \in \{g^{ab}, g^c\}$, is
unable to tell if $y = g^{ab}$ or $y = g^c$ (Lecture 08 Wikström
DD2448).

The semantic security of the El Gamal cryptosystem relies on the
Decisional Diffe-Hellman assumption in finite cyclic groups
$G_q$. This means that the El Gamal cryptosystem is secure as long as
the assumption is true. (Lecture 08 Wikström DD2448)

\subsubsection{Properties}
If $G_q$ is a group, then so is $G_q \times G_q$ with the group
operation defined as $(a,b)(c,d) = (a c, b d)$ for any $(a,b),(c,d)
\in G_q \times G_q$. From this and the definition of the El Gamal
cryptosystem, one can deduce that it is \emph{homomorphic}. This means that
for any two messages $m_1, m_2 \in G_q$ and randomnesses $s_1, s_2 \in
\mathbb{Z}_q$
$$
 \mathrm{Enc}_{pk}(m_1, s_1)\mathrm{Enc}_{pk}(m_2, s_2) =
(g^{s_1}, y^{s_1}m_1)(g^{s_2},y^{s_2}m_2) =
$$
$$
= (g^{s_1 + s_2}, y^{s_1 + s_2}m_1m_2) = \mathrm{Enc}_{pk}(m_1m_2, s_1 + s_2)
$$

that is, the encryption of the product of two messages equals the
product of the encryptions of the messages \cite[p.~289]{hac}. In
particular, by choosing $m_1 = m$ and $m_2 = 1$ one obtains
$$
\mathrm{Enc}_{pk}(m, s_1) \mathrm{Enc}_{pk}(1, s_2) = \mathrm{Enc}_{pk}(m, s_1 + s_2)
$$

This homomorphic property of the El Gamal Cryptosystem may be used to
reencrypt an already encrypted message. If $s_1 \in \mathbb{Z}_q$ and
$s_2 \in \mathbb{Z}_q$ are chosen with uniform randomness, then $s_1 +
s_2 \in \mathbb{Z}_q$ will be uniformly random as well. So the
distribution of ciphertexts encrypted once will be indistinguishable
from the distribution of ciphertexts that have been reencrypted
\cite[p.~1]{wikstrom1}.

For future convenience we define
$$
\mathrm{ReEnc}_{pk}(c,s) = c \cdot \mathrm{Enc}_{pk}(1,s) 
$$

As will become clear, this reencryption function will be used to
enable hidden shuffling in mix-nets.

